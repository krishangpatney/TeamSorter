<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="">
        <script type="text/javascript" src="https://unpkg.com/album-art"></script>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    </head>
    <body style = "max-width: 900px;">
        <div class="card">
            <div class="card-body">
                <center><h5 class="card-title">Team Creator</h5>
                    <br>
                <p class="card-text">
                    <form>
                        <div class="form-group">
                            <div class="form-row">
                                <div class="col-md-8 mb-2">
                                    <br>
                                    <input type="text" class="form-control" id="player" aria-describedby="emailHelp" placeholder="Player Name - required"  onkeydown = "if (event.keyCode == 13)
                                    document.getElementById('addPerson').click()" >
                                </div>
      
                                <div class="col-md-4 mb-2">
                                    <div class="slidecontainer">
                                        Skill Level<br>
                                        <input type="range" name="skill" min="0" max="10" value="0" style="width: 180px;" onchange="updateTextInput(this.value);">
                                        <br><a id="textInput"> 0 </a>

                                    </div>
                                </div>
                              
                            </div>
                          
                            
                            <br>
                            <a id = "addPerson" onclick="addPerson()" style="color: white;" class="btn btn-primary">Add Player</a>
                            <a id = "makeTeam" onclick="makeTeam()" style="color: white;" class="btn btn-primary">Skill-Based</a>
                            <a id = "randomizedTeam" onclick="randomizedTeam()" style="color: white;" class="btn btn-primary">Randomized</a>
                        </div>
                        <span class="error"><p id="error"></p></span>
                    </center>
                    </form>
                </p>
<!-- LISTS -->
                <br>
                <ul class="list-group" id = "players">
                    
                </ul> 
                <div class="card" id = "team1card"  style="display: none;">
                    <div class="card-body">
                        <h5 class="card-title">Team One</h5>
                        <ul class="list-group" id = "team1">
                            
                        </ul>
                    </div>
                </div>
                <br>
                <div class="card" id = "team2card"  style="display: none;">
                    <div class="card-body">
                        <h5 class="card-title">Team Two</h5>
                        <ul class="list-group" id = "team2">
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </body>

    <script> 

    // make an array of people 
        var people = {};
        

        // var numberOfTeams = document.getElementById("numberOfTeams").value;
        var numberOfTeams = 2;


        function updateTextInput(val) {
            document.getElementById("textInput").innerHTML = val;
        }

        function addPerson(){
            document.getElementById("players").style.display = "block";
            document.getElementById("team1card").style.display = "none";
            document.getElementById("team2card").style.display = "none";

            var person = document.getElementById('player').value;
            var skill = document.getElementById("textInput").innerHTML;

            if (person != ""){
                people[person] = skill;                
                document.querySelector(".list-group").innerHTML += "<li class=\"list-group-item\">Name : {n} || Skill :  {s}</li>".replace("{n}", (person)).replace("{s}", skill);
                document.getElementById('error').innerHTML = '';
            } else {
                nameError = "Please enter a name";
                document.getElementById("error").innerHTML = nameError; 
            }
            // resits 
            document.getElementById('player').value = '';
        }
        
        // Skill Based team selection
        function skillSort(){
            var team1 = [];
            var team2 = [];

            const players = [];
            var sortedPlayers = [];

            for (var key in people){
                // key, dict[key]
                person = {"name" : key, "skill" : parseInt(people[key])};
                players.unshift(person);
            }

            // uses this to sort array 
            function compare(a, b) {
                const playerA = a.skill;
                const playerB = b.skill;

                let comparison = 0;
                if (playerA > playerB) {
                    comparison = 1;
                } else if (playerA < playerB) {
                    comparison = -1;
                }
                    return comparison;
            }

            // sort players
            players.sort(compare);
            
            // Create an array of all the players sorted 
            players.forEach((element) => {
                sortedPlayers.push(element.name);
            });

         
            var odd = function (array) {
                for (i=1; i <= array.length-1; i+=2) {

                    team1.push(array[i]);
                }
            }
            var even = function (array) {
                for (i=0; i <= array.length-1; i+=2) {

                    team2.push(array[i]);
                }
            }

            odd(sortedPlayers);
            
            even(sortedPlayers);
            arr = [team1, team2];
            return arr;
        }

        // Shuffle Players
        function shuffle(array) {
            var i;
            var playerNumbers = array.length;
            copy = [];
            while (playerNumbers){
                i = Math.floor(Math.random() * playerNumbers--);

                copy.push(array.splice(i,1)[0]);
            }
            return copy; 
        }

        // Splits the array into n arrays 
        function splitArray(arr,n){
            var splits = Math.max(arr.length/n ,1);
            var split = [];
            for (var i = 0; i < n; i++) {
                if(splits*(i+1)<=arr.length)split.push(arr.slice(splits*i, splits*(i+1)));
            }
            return split; 
        }

        // Randomized teams instead of skill based
        function randomizedTeam(){

            const players = [];

            // Add people to player array
            for (var key in people){
                // key, dict[key]
                person = {"name" : key, "skill" : parseInt(people[key])};
                players.unshift(person);
            }
            // Add player
            var playerList = [];

            players.forEach((element) => {
                playerList.push(element.name);
            });

            var shuffledPlayers = shuffle(playerList);

            var teams = splitArray(shuffledPlayers,2);

            createTeam(teams[0], teams[1]);

        }

        function makeTeam(){
            var team = skillSort();
            
            createTeam(team[0],team[1]);

        }

        // helper function to create two seperate team lists. 
        function createTeam(arr1,arr2){
            cleanBoard();
            for (i=0; i <= arr1.length-1; i++) {
                document.getElementById("team1").innerHTML += "<li class=\"list-group-item\">Name : {n} || Skill : {s} </li>".replace("{n}", (arr1[i])).replace("{s}", people[arr1[i]]);
                }

            for (i=0; i <= arr2.length-1; i++) {
                document.getElementById("team2").innerHTML += "<li class=\"list-group-item\">Name : {n} || Skill : {s} </li>".replace("{n}", (arr2[i])).replace("{s}", people[arr2[i]]);
                }

        }

        function cleanBoard(){
            document.getElementById("team1").innerHTML = "";
            document.getElementById("team2").innerHTML = "";

            document.getElementById("players").style.display = "none";
            document.getElementById("team1card").style.display = "block";
            document.getElementById("team2card").style.display = "block";
        }
    </script>


</html>
